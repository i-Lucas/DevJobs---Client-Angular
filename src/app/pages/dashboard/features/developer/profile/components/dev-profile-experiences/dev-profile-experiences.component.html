<dev-profile-panel
    [icon]="'work'"
    [isOwner]="isOwner"
    [loading]="loading"
    (onEdit)="isModalOpen = true"
    [label]="'Experiência Profissional'"
    >

    <div class="flex flex-column gap-4 md:pr-4 md:py-2">

        @if (!(experiencesList && experiencesList.length > 0)) {

            <h4>empty</h4>

        } @else {

            @for (experience of experiencesList; track experience; let idx = $index) {

                    <div class="flex flex-column">
        
                        <div class="flex gap-2 justify-content-between align-items-center">
        
                            <span class="font-bold text-2xl">{{ experience.company }}</span>
        
                            @if (experience.current_job) {
                                <p-tag 
                                    severity="info"
                                    icon="pi pi-check" 
                                    value="Emprego Atual"
                                    [style]="{ 'font-size': '8px' }" 
                                />
                            }

                        </div>
        
                        <span class="mt-2 text-xs font-bold">{{ experience.occupation }}</span>
        
                        <div class="mt-2 flex gap-2 text-xs text-600">
                            <span>De: {{experience.from | msToMMyyyy}}</span>
                            <span>Até: {{experience.to | msToMMyyyy}}</span>
                        </div>
        
                        <span class="mt-3 text-sm text-justify line-height-3">
                            {{ experience.resume }}                        
                        </span>
                    </div>

                @if (idx < experiencesList.length - 1) { 
                    <p-divider styleClass="m-0" />
                }
            }
        }

    </div>

</dev-profile-panel>

<app-modal 
    [icon]="'work'"
    [loading]="loading"
    [isOpen]="isModalOpen"
    [title]="'Editar Experiência Profissional'"
    (onClose)="isModalOpen = !isModalOpen">

    <p-tabView>

        @if(experiencesList) {

            @for (currentForm of experiencesFormList; track currentForm; let idx = $index) {

                <p-tabPanel header="{{experiencesList[idx].company}}">

                    <div class="my-4">

                        <app-developer-job-experiences-form
                            [jobExperiencesForm]="currentForm"
                        />

                        <div class="mt-4">
                            <p-button 
                                size="small"
                                label="Salvar" 
                                icon="pi pi-check"
                                [loading]="loading"
                                [disabled]="currentForm.invalid || loading"
                                (click)="onSave.emit({ form: currentForm, identifier: 'DEVELOPER_EXPERIENCES' })"
                            />
                        </div>
                    </div>
                    
                </p-tabPanel>
            }
        }

    </p-tabView>
</app-modal>